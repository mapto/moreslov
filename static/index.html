<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>moreever - Syntactic Identification of Values in Text Corpora</title>
    <link rel="stylesheet" href="style.css">
    <style>
body {
    display: flex;
    height: 100vh;
    overflow: hidden;
}

form select {
    float: right;
}

footer {
  position: absolute;
  bottom: 0;
  right: 0;
  height: 4em;
  padding: 5px;
  background-color: whitesmoke;
}

footer div {
    float: right;
    padding-left: 10px;
}

.row {
  display: flex;
}
  
#list {
    position: absolute;
    width: 250px;
    height: 90%;
    border: none
}

#fulltext {
    left: 250px;
    width: 600px;
    position: absolute;
    height: 100%;
    border: none;
}

#values-container {
    left: 850px;
    width: 1000px;
    position: absolute;
    overflow: scroll;
    height: 99vh;
    border: 0;
}

#values {
    width: 100%;
    height: 100%;
    border: none;
}
    </style>
    <script>
        let init = () => {
            var vocab = document.getElementById("vocab-select");
            var stemmer = document.getElementById("stemmer-select");
            var corpus = document.getElementById("corpus-select");
            var list = document.getElementById("list");
            var fulltext = document.getElementById("fulltext");
            var values = document.getElementById("values");

            let tryUpdate = async (iPossiblyBogusURL) => {
                const response = await fetch(iPossiblyBogusURL);
                
                if (response.status == 200) {
                    fulltext.src = iPossiblyBogusURL;
                } else {
                    console.log("Unable to find: " + iPossiblyBogusURL)
                }
            }

            let update = () => {
                values.src = stemmer.value + "/" + vocab.value + "/values.html";
                if (corpus.value == "all") {
                    list.src = stemmer.value + "/" + vocab.value + "/index.html";
                } else {
                    list.src = stemmer.value + "/" + vocab.value + "/" + corpus.value + "/index.html";
                }
                let text_corpus = corpus.value;
                if (text_corpus == "all") {
                    const prefix = fulltext.src.substr(0,fulltext.src.lastIndexOf("/"));
                    text_corpus = prefix.substr(prefix.lastIndexOf("/")+1);
                }
                // console.log(text_corpus);
                // console.log(prefix);
                // console.log(stemmer.value + "/" + text_corpus + fulltext.src.substr(fulltext.src.lastIndexOf("/")));
                tryUpdate(stemmer.value + "/" + vocab.value + "/" + text_corpus + fulltext.src.substr(fulltext.src.lastIndexOf("/")));
            }

            if (window.location.hash) {
                console.log("Route is " + window.location.hash);
                const url = window.location.hash.replace("/index.html#", "").replace("#", "");
                console.log("URL is " + url);
                tryUpdate(url);
            }

            vocab.addEventListener('change', update);
            stemmer.addEventListener('change', update);
            corpus.addEventListener('change', update);
        }

    </script>
  </head>
<body onload="init()">
    <form class="menu">
        <div>
        <h1 class="title"><a href="https://github.com/umilISLab/moreever/">moreever</a></h1>
        </div>
        <div>
            <label for="vocab-select">Vocabulary:</label>
            <select name="vocab" id="vocab-select">
                <option value="variation">Variation</option>
                <option value="values">Values</option>
            </select>
        </div>
        <div>
            <label for="stemmer-select">Stemmer:</label>
            <!-- List defined in stemmers.py -->
            <select name="stemmer" id="stemmer-select">
                <option value="sb">Snowball</option>
                <option value="sb2">Snowball (repeated)</option>
                <option value="lan">Lancaster</option>
                <option value="ps">Porter</option>
                <option value="morph">Morphological Root</option>
                <option value="wnl">Lemmatizer</option>
                <option value="dummy">No Stemming</option>
            </select>
        </div>
        <div>
            <!-- TODO: load corpora dynamically -->
            <label for="corpus-select">Corpus:</label>
            <select name="corpus" id="corpus-select">
                <option value="all">all</option>
                <option value="A">A</option>
                <option value="B">B</option>
                <option value="C">C</option>
            </select>
        </div>
        <br/>
        <div>
            <iframe name="list" id="list" src="sb/variation/index.html"></iframe>
        </div>s
    </form>
    <!-- TODO: generalise to first text in corpus list -->
    <iframe name="fulltext" id="fulltext" src="sb/variation/B/3184.html"></iframe> 
    <div id="values-container">
        <iframe name="values" id="values" src="sb/variation/values.html"></iframe> 
    </div>
    <footer>
      <a href="https://dllcm.unimi.it/"><img src="/logo-unimi.svg" height="100%"/></a>
      <div>
        developed at<br/>
        Universit√† degli Studi di Milano<br/>
        <a href="https://dllcm.unimi.it/">https://dllcm.unimi.it/</a>
      </div>
    </footer>
</body></html>
